var win=Ti.UI.currentWindow;var imageDisplay=null;var infoLabel=Ti.UI.createLabel({top:20,width:'auto',height:'auto'});var groups=Ti.Contacts.getAllGroups();if(groups.length===0){Ti.Contacts.save();var testGroup=Ti.Contacts.createGroup();testGroup.name='__KSTESTGROUP';Ti.Contacts.save();groups=Ti.Contacts.getAllGroups();}
var selectedGroup=groups[0];var data=[];var people=[];var updatePeople=function(){people=selectedGroup.members();var text='People: ';if(people!=null){for(var i=0;i<people.length;i++){text+=people[i].fullName+', ';}}
else{people=[];}
infoLabel.text=text;};for(var i=0;i<groups.length;i++){data[i]=Ti.UI.createPickerRow({title:groups[i].name});}
var groupPicker=Ti.UI.createPicker({top:50});groupPicker.addEventListener('change',function(e){selectedGroup=groups[e.rowIndex];updatePeople();});groupPicker.selectionIndicator=true;groupPicker.add(data);var addPerson=Ti.UI.createButton({title:'Add person',left:10,bottom:20,width:120,height:40});addPerson.addEventListener('click',function(){Ti.Contacts.showContacts({selectedPerson:function(e){selectedGroup.add(e.person);Ti.Contacts.save();updatePeople();}});});var removePerson=Ti.UI.createButton({title:'Remove person',right:10,bottom:20,width:120,height:40});removePerson.addEventListener('click',function(){Ti.Contacts.showContacts({selectedPerson:function(e){selectedGroup.remove(e.person);Ti.Contacts.save();updatePeople();}});});win.add(infoLabel);win.add(groupPicker);win.add(addPerson);win.add(removePerson);win.addEventListener('open',function(){if(data.length>1){groupPicker.setSelectedRow(0,1,false);groupPicker.setSelectedRow(0,0,false);}});